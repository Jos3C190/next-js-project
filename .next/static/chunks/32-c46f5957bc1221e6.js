"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[32],{1886:(e,t,r)=>{async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,a="".concat("http://localhost:5000").concat(e),s={"Content-Type":"application/json",...t.headers};r&&(s.Authorization="Bearer ".concat(r));let o={...t,headers:s},n=await fetch(a,o);if(!n.ok){let e="Error ".concat(n.status,": ").concat(n.statusText);try{let t=await n.json();t.message?e=t.message:t.error?e=t.error:t.errors&&Array.isArray(t.errors)&&(e=t.errors.join(", "))}catch(e){}if(401===n.status)throw localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/",Error("Token inv\xe1lido");throw Error(e)}return n.json()}r.d(t,{Vg:()=>o,ZQ:()=>s,rn:()=>n});let s={login:async e=>a("/api/auth/login",{method:"POST",body:JSON.stringify(e)}),register:async e=>a("/api/auth/register",{method:"POST",body:JSON.stringify(e)}),verify:async e=>a("/api/auth/verify",{method:"GET"},e)},o=e=>({getStats:()=>a("/api/dashboard/stats",{method:"GET"},e),getRecentAppointments:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return a("/api/dashboard/recent-appointments?limit=".concat(t),{method:"GET"},e)},getActivity:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return a("/api/dashboard/activity?limit=".concat(t),{method:"GET"},e)},getAllAppointments:()=>a("/api/citas",{method:"GET"},e)}),n=e=>({getPatients:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return a("/pacientes?page=".concat(t,"&limit=").concat(r),{method:"GET"},e)},getPatientById:t=>a("/pacientes/".concat(t),{method:"GET"},e),createPatient:t=>a("/pacientes",{method:"POST",body:JSON.stringify(t)},e),updatePatient:(t,r)=>a("/pacientes/".concat(t),{method:"PUT",body:JSON.stringify(r)},e),deletePatient:t=>a("/pacientes/".concat(t),{method:"DELETE"},e)})},5731:(e,t,r)=>{r.d(t,{A:()=>c,AuthProvider:()=>d});var a=r(5155),s=r(2115),o=r(1886);let n=(0,s.createContext)(null),i="auth_token",l="auth_user",d=e=>{let{children:t}=e,[r,d]=(0,s.useState)(!1),[c,h]=(0,s.useState)(null),[m,u]=(0,s.useState)(null),[x,p]=(0,s.useState)(!0),[f,v]=(0,s.useState)(null),[b,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{g(!0)},[]),(0,s.useEffect)(()=>{b&&(async()=>{try{let e=localStorage.getItem(i),t=localStorage.getItem(l);if(e&&t)try{await o.ZQ.verify(e),u(e),h(JSON.parse(t)),d(!0),console.log("✅ Sesi\xf3n restaurada correctamente")}catch(e){console.error("❌ Token inv\xe1lido:",e),localStorage.removeItem(i),localStorage.removeItem(l),d(!1),h(null),u(null)}else console.log("ℹ️ No hay sesi\xf3n guardada"),d(!1)}catch(e){console.error("❌ Error al cargar la autenticaci\xf3n:",e),d(!1)}finally{p(!1)}})()},[b]);let y=async e=>{v(null);try{p(!0);let t=await o.ZQ.login(e),r={id:t.user._id,nombre:t.user.nombre,apellido:t.user.apellido,correo:t.user.correo,role:t.role,telefono:t.user.telefono,especialidad:t.user.especialidad};return u(t.token),h(r),d(!0),b&&(localStorage.setItem(i,t.token),localStorage.setItem(l,JSON.stringify(r))),console.log("✅ Login exitoso"),!0}catch(e){return console.error("❌ Error de inicio de sesi\xf3n:",e),v("Credenciales incorrectas. Por favor, int\xe9ntelo de nuevo."),!1}finally{p(!1)}},j=async e=>{v(null);try{return p(!0),await o.ZQ.register(e),!0}catch(e){return console.error("❌ Error de registro:",e),v("Error al registrar. Por favor, int\xe9ntelo de nuevo."),!1}finally{p(!1)}};return(0,a.jsx)(n.Provider,{value:{isAuthenticated:r,user:c,token:m,login:y,logout:()=>{d(!1),h(null),u(null),b&&(localStorage.removeItem(i),localStorage.removeItem(l)),console.log("✅ Logout exitoso")},register:j,isLoading:x,error:f,isHydrated:b},children:t})},c=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useAuth debe ser usado dentro de un AuthProvider");return e}},9032:(e,t,r)=>{r.d(t,{A:()=>k});var a=r(5155),s=r(2115),o=r(7340),n=r(7580),i=r(9074),l=r(4395),d=r(3917),c=r(1586),h=r(2749),m=r(7434),u=r(741),x=r(4416),p=r(3052),f=r(4835),v=r(5695),b=r(5731),g=r(6766);let y=[{name:"Panel Principal",icon:o.A,path:"/dashboard"},{name:"Pacientes",icon:n.A,path:"/dashboard/patients"},{name:"Citas",icon:i.A,path:"/dashboard/appointments"},{name:"Expedientes",icon:l.A,path:"/dashboard/records"},{name:"Tratamientos",icon:d.A,path:"/dashboard/treatments"},{name:"Pagos y Facturaci\xf3n",icon:c.A,path:"/dashboard/payments"},{name:"Usuarios",icon:h.A,path:"/dashboard/users"},{name:"Reportes",icon:m.A,path:"/dashboard/reports"},{name:"Estad\xedsticas",icon:u.A,path:"/dashboard/statistics"}],j=e=>{let{open:t,setOpen:r}=e,{logout:s}=(0,b.A)(),o=(0,v.useRouter)(),n=(e=>"/dashboard"===e?"Panel Principal":e.startsWith("/dashboard/patients")?"Pacientes":e.startsWith("/dashboard/appointments")?"Citas":e.startsWith("/dashboard/records")?"Expedientes":e.startsWith("/dashboard/treatments")?"Tratamientos":e.startsWith("/dashboard/payments")?"Pagos y Facturaci\xf3n":e.startsWith("/dashboard/users")?"Usuarios":e.startsWith("/dashboard/reports")?"Reportes":e.startsWith("/dashboard/statistics")?"Estad\xedsticas":"Panel Principal")((0,v.usePathname)()),i=e=>{o.push(e.path),window.innerWidth<768&&r(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 z-20 transition-opacity md:hidden ".concat(t?"opacity-100 ease-out duration-300":"opacity-0 ease-in duration-200 pointer-events-none"),onClick:()=>r(!1)}),(0,a.jsxs)("div",{className:"fixed inset-y-0 left-0 flex flex-col z-30 w-64 bg-[hsl(var(--sidebar-bg))] transform transition md:translate-x-0 md:relative md:shadow-none transition-colors duration-200 ".concat(t?"translate-x-0 ease-out duration-300":"-translate-x-full ease-in duration-200"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between h-20 flex-shrink-0 px-4 border-b border-[hsl(var(--sidebar-border))]",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(g.default,{src:"/images/logo.png",alt:"Logo",width:48,height:48,className:"rounded-full mr-3"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-red-400",children:"Clinica Dental"}),(0,a.jsx)("span",{className:"text-sm text-amber-400",children:"Dra. Linares"})]})]}),(0,a.jsxs)("button",{className:"md:hidden rounded-md p-2 text-[hsl(var(--sidebar-foreground))] hover:text-white hover:bg-[hsl(var(--sidebar-accent-hover))] focus:outline-none transition-colors duration-200",onClick:()=>r(!1),children:[(0,a.jsx)("span",{className:"sr-only",children:"Close sidebar"}),(0,a.jsx)(x.A,{className:"h-6 w-6"})]})]}),(0,a.jsx)("div",{className:"flex-1 flex flex-col overflow-y-auto pt-5 pb-4 bg-[hsl(var(--sidebar-bg))]",children:(0,a.jsx)("nav",{className:"mt-2 flex-1 px-3 space-y-2",children:y.map(e=>(0,a.jsxs)("button",{onClick:()=>i(e),className:"group flex items-center justify-between w-full px-3 py-3 text-sm font-medium rounded-md transition-all duration-200 ".concat(n===e.name?"bg-red-400 text-gray-900":"text-[hsl(var(--sidebar-foreground))] hover:bg-[hsl(var(--sidebar-accent))] hover:text-amber-400"),children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(e.icon,{className:"mr-3 h-5 w-5 ".concat(n===e.name?"text-gray-900":"text-[hsl(var(--sidebar-foreground))] group-hover:text-amber-400")}),e.name]}),n===e.name&&(0,a.jsx)(p.A,{className:"h-4 w-4 text-gray-900"})]},e.name))})}),(0,a.jsx)("div",{className:"flex-shrink-0 flex border-t border-[hsl(var(--sidebar-border))] p-4 bg-[hsl(var(--sidebar-bg))]",children:(0,a.jsxs)("button",{onClick:()=>{s(),o.push("/")},className:"flex items-center w-full px-3 py-2 text-sm font-medium rounded-md text-[hsl(var(--sidebar-foreground))] hover:bg-[hsl(var(--sidebar-accent))] hover:text-amber-400 transition-colors duration-200",children:[(0,a.jsx)(f.A,{className:"mr-3 h-5 w-5 text-[hsl(var(--sidebar-foreground))]"}),"Cerrar sesi\xf3n"]})})]})]})};var N=r(4783),w=r(4186),A=r(2098),S=r(3509);let E=(0,s.createContext)(void 0);function P(e){let{children:t}=e,[r,o]=(0,s.useState)("light");return(0,s.useEffect)(()=>{let e=localStorage.getItem("theme");e?o(e):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&o("dark")},[]),(0,s.useEffect)(()=>{document.documentElement.setAttribute("data-theme",r),localStorage.setItem("theme",r)},[r]),(0,a.jsx)(E.Provider,{value:{theme:r,toggleTheme:()=>{o(e=>"light"===e?"dark":"light")}},children:t})}var C=r(6408);let T=e=>{let{sidebarOpen:t,setSidebarOpen:r}=e,{user:o}=(0,b.A)(),{theme:n,toggleTheme:l}=function(){let e=(0,s.useContext)(E);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}(),[d,c]=(0,s.useState)(new Date);return(0,s.useEffect)(()=>{let e=setInterval(()=>{c(new Date)},1e3);return()=>{clearInterval(e)}},[]),(0,a.jsx)("header",{className:"bg-[hsl(var(--header-bg))] border-b border-[hsl(var(--header-border))] shadow-sm z-10 transition-colors duration-200",children:(0,a.jsx)("div",{className:"px-4 sm:px-6 lg:px-8 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("button",{type:"button",className:"md:hidden p-2 rounded-md text-[hsl(var(--muted-foreground))] hover:text-[hsl(var(--foreground))] hover:bg-[hsl(var(--card-hover))] focus:outline-none transition-colors duration-200",onClick:()=>r(!t),children:[(0,a.jsx)("span",{className:"sr-only",children:"Abrir men\xfa"}),(0,a.jsx)(N.A,{className:"h-6 w-6"})]}),(0,a.jsxs)("div",{className:"hidden md:flex items-center ml-4 text-[hsl(var(--muted-foreground))]",children:[(0,a.jsxs)("div",{className:"flex items-center mr-4",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 mr-2 text-red-400"}),(0,a.jsx)("span",{className:"text-sm font-medium capitalize",children:new Intl.DateTimeFormat("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(d)})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 mr-2 text-amber-400"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:new Intl.DateTimeFormat("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).format(d)})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(C.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:l,className:"p-2 rounded-full bg-[hsl(var(--secondary))] text-[hsl(var(--secondary-foreground))] hover:bg-[hsl(var(--card-hover))] transition-colors duration-200","aria-label":"dark"===n?"Cambiar a modo claro":"Cambiar a modo oscuro",children:"dark"===n?(0,a.jsx)(A.A,{className:"h-5 w-5"}):(0,a.jsx)(S.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"hidden md:flex flex-col items-end mr-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-[hsl(var(--foreground))]",children:(()=>{if((null==o?void 0:o.nombre)&&(null==o?void 0:o.apellido))return"".concat(o.nombre," ").concat(o.apellido);if(null==o?void 0:o.nombre)return o.nombre;if(null==o?void 0:o.correo){let e=o.correo.split("@")[0];return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}return"Usuario"})()}),(0,a.jsx)("span",{className:"text-xs text-[hsl(var(--muted-foreground))]",children:(null==o?void 0:o.role)?({admin:"Administrador",doctor:"Doctor",dentista:"Dentista",ortodoncista:"Ortodoncista",asistente:"Asistente",recepcionista:"Recepcionista",user:"Usuario",patient:"Paciente"})[o.role.toLowerCase()]||o.role:"Usuario"})]}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-red-400 flex items-center justify-center text-white font-medium",children:(null==o?void 0:o.nombre)?o.nombre.charAt(0).toUpperCase():(null==o?void 0:o.correo)?o.correo.charAt(0).toUpperCase():"U"})]})]})})})},k=e=>{let{children:t}=e,[r,o]=(0,s.useState)(!1),[n,i]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=setTimeout(()=>{i(!1)},500);return()=>clearTimeout(e)},[]),(0,a.jsx)(P,{children:(0,a.jsxs)("div",{className:"flex h-screen bg-[hsl(var(--dashboard-bg))] transition-colors duration-200",children:[(0,a.jsx)(j,{open:r,setOpen:o}),(0,a.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden",children:[(0,a.jsx)(T,{sidebarOpen:r,setSidebarOpen:o}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:n?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-400"})}):(0,a.jsx)(C.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"h-full",children:t})}),(0,a.jsx)("footer",{className:"bg-[hsl(var(--header-bg))] border-t border-[hsl(var(--header-border))] py-3 px-6 text-center text-sm text-[hsl(var(--muted-foreground))] transition-colors duration-200",children:(0,a.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Cl\xednica Dental Dra. Linares. Todos los derechos reservados."]})})]})]})})}}}]);