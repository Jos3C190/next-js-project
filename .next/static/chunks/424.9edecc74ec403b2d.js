"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[424],{7424:(e,a,t)=>{t.r(a),t.d(a,{default:()=>R});var s=t(5155),r=t(2115),l=t(760),i=t(6408),d=t(3904),n=t(9074),o=t(5339),c=t(7580),m=t(9397),x=t(5868),h=t(4186),u=t(5731),p=t(1886),g=t(2596),v=t(9688);function b(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,v.QP)((0,g.$)(a))}let f=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:b("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});f.displayName="Card";let j=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:b("flex flex-col space-y-1.5 p-6",t),...r})});j.displayName="CardHeader",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:b("text-2xl font-semibold leading-none tracking-tight",t),...r})}).displayName="CardTitle",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:b("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription";let N=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:b("p-6 pt-0",t),...r})});N.displayName="CardContent",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:b("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter";let y=e=>{let{title:a,value:t,icon:r}=e;return(0,s.jsxs)(f,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow duration-200",children:[(0,s.jsxs)(j,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a}),r&&(0,s.jsx)("div",{className:"p-2 bg-red-50 dark:bg-red-900/20 rounded-lg text-red-600 dark:text-red-400",children:r})]}),(0,s.jsx)(N,{className:"pt-0",children:(0,s.jsx)("div",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:t})})]})};var w=t(4416);let S=e=>{let{activities:a}=e,[t,l]=(0,r.useState)(!1),d=(e,a)=>{let t=e.charAt(0).toUpperCase(),s=a.charAt(0).toUpperCase();return"".concat(t).concat(s)},n=e=>{switch(e){case"tratamiento":return"bg-red-400";case"cita":return"bg-amber-400";case"paciente":return"bg-blue-400";default:return"bg-gray-500"}},o=e=>{let a=new Date,t=new Date(e),s=Math.floor((a.getTime()-t.getTime())/6e4);if(s<1)return"hace un momento";if(s<60)return"hace ".concat(s," minuto").concat(s>1?"s":"");let r=Math.floor(s/60);if(r<24)return"hace ".concat(r," hora").concat(r>1?"s":"");let l=Math.floor(r/24);return"hace ".concat(l," d\xeda").concat(l>1?"s":"")},c=e=>new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),m=e=>{let{activity:t,index:r,showFullDate:l=!1}=e;return(0,s.jsx)(i.P.li,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*r},children:(0,s.jsxs)("div",{className:"relative pb-8",children:[r!==a.length-1?(0,s.jsx)("span",{className:"absolute top-5 left-5 -ml-px h-full w-0.5 bg-[hsl(var(--border))]","aria-hidden":"true"}):null,(0,s.jsxs)("div",{className:"relative flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"".concat(n(t.type)," h-10 w-10 rounded-full flex items-center justify-center text-white shadow-md text-xs font-bold"),children:d(t.type,t.action)})}),(0,s.jsx)("div",{className:"min-w-0 flex-1",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm",children:(0,s.jsx)("span",{className:"text-[hsl(var(--foreground))]",children:t.description})}),(0,s.jsxs)("div",{className:"mt-0.5 flex items-center text-xs text-[hsl(var(--muted-foreground))]",children:[(0,s.jsx)("span",{children:t.userRole}),(0,s.jsx)("span",{className:"mx-1",children:"•"}),(0,s.jsx)("span",{children:l?c(t.timestamp):o(t.timestamp)})]})]})})]})]})},t._id)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.P.div,{whileHover:{boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},transition:{duration:.2},className:"bg-[hsl(var(--card))] rounded-lg shadow-md p-6 transition-colors duration-200 h-[500px] flex flex-col",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-[hsl(var(--foreground))] mb-4",children:"Actividad Reciente"}),a.length>0?(0,s.jsx)("div",{className:"flow-root flex-1 overflow-y-auto",children:(0,s.jsx)("ul",{className:"-mb-8",children:a.slice(0,5).map((e,a)=>(0,s.jsx)(m,{activity:e,index:a},e._id))})}):(0,s.jsx)("p",{className:"text-[hsl(var(--muted-foreground))] text-center py-4",children:"No hay actividad reciente"}),(0,s.jsx)("div",{className:"mt-4 text-center flex-shrink-0",children:(0,s.jsx)("button",{onClick:()=>l(!0),className:"text-sm font-medium text-red-400 hover:text-red-500 transition-colors duration-200",children:"Ver toda la actividad"})})]}),t&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:()=>l(!1)}),(0,s.jsxs)("div",{className:"inline-block align-bottom bg-[hsl(var(--card))] rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[(0,s.jsx)("div",{className:"bg-[hsl(var(--card))] px-6 py-4 border-b border-[hsl(var(--border))]",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-[hsl(var(--foreground))]",children:["Toda la Actividad (",a.length," actividades)"]}),(0,s.jsx)("button",{onClick:()=>l(!1),className:"text-[hsl(var(--muted-foreground))] hover:text-[hsl(var(--foreground))] transition-colors duration-200",children:(0,s.jsx)(w.A,{className:"h-6 w-6"})})]})}),(0,s.jsx)("div",{className:"bg-[hsl(var(--card))] px-6 py-4 max-h-96 overflow-y-auto",children:a.length>0?(0,s.jsx)("div",{className:"flow-root",children:(0,s.jsx)("ul",{className:"-mb-8",children:a.map((e,a)=>(0,s.jsx)(m,{activity:e,index:a,showFullDate:!0},e._id))})}):(0,s.jsx)("p",{className:"text-[hsl(var(--muted-foreground))] text-center py-8",children:"No hay actividades registradas"})}),(0,s.jsx)("div",{className:"bg-[hsl(var(--card))] px-6 py-4 border-t border-[hsl(var(--border))]",children:(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-red-400 text-white rounded-md hover:bg-red-500 transition-colors duration-200",children:"Cerrar"})})})]})]})})]})};var A=t(2355),C=t(3052),k=t(1007),D=t(6874),M=t.n(D);let P=e=>{let{appointments:a}=e,[t,l]=(0,r.useState)(new Date),[d,o]=(0,r.useState)(null),c=new Date(t.getFullYear(),t.getMonth(),1),m=new Date(t.getFullYear(),t.getMonth()+1,0),x=c.getDay(),u=(0,r.useMemo)(()=>{let e=[],a=new Date(t.getFullYear(),t.getMonth()-1,0);for(let t=x-1;t>=0;t--)e.push({date:new Date(a.getFullYear(),a.getMonth(),a.getDate()-t),isCurrentMonth:!1});for(let a=1;a<=m.getDate();a++)e.push({date:new Date(t.getFullYear(),t.getMonth(),a),isCurrentMonth:!0});let s=42-e.length;for(let a=1;a<=s;a++)e.push({date:new Date(t.getFullYear(),t.getMonth()+1,a),isCurrentMonth:!1});return e},[t,x,m]),p=e=>{let t=e.toISOString().split("T")[0];return a.filter(e=>new Date(e.fecha).toISOString().split("T")[0]===t)},g=e=>{l(a=>{let t=new Date(a);return"prev"===e?t.setMonth(a.getMonth()-1):t.setMonth(a.getMonth()+1),t}),o(null)},v=e=>{let a=new Date;return e.toDateString()===a.toDateString()},b=d?a.filter(e=>new Date(e.fecha).toISOString().split("T")[0]===d):[],f=e=>{switch(e){case"completada":return"bg-green-100 text-green-800";case"pendiente":return"bg-blue-100 text-blue-800";case"cancelada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=e=>{switch(e){case"completada":return"Completada";case"pendiente":return"Pendiente";case"cancelada":return"Cancelada";default:return e}},N=e=>e.pacienteId?"".concat(e.pacienteId.nombre," ").concat(e.pacienteId.apellido):e.pacienteTemporalId?"".concat(e.pacienteTemporalId.nombre," ").concat(e.pacienteTemporalId.apellido):"Paciente desconocido";return(0,s.jsxs)(i.P.div,{whileHover:{boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},transition:{duration:.2},className:"bg-[hsl(var(--card))] rounded-lg shadow-md p-6 transition-colors duration-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-[hsl(var(--foreground))] flex items-center",children:[(0,s.jsx)(n.A,{className:"h-5 w-5 mr-2 text-red-400"}),"Calendario de Citas"]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(i.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>g("prev"),className:"p-2 rounded-full hover:bg-[hsl(var(--secondary))] transition-colors duration-200",children:(0,s.jsx)(A.A,{className:"h-4 w-4 text-[hsl(var(--muted-foreground))]"})}),(0,s.jsx)("span",{className:"text-sm font-medium text-[hsl(var(--foreground))] min-w-[140px] text-center",children:t.toLocaleDateString("es-ES",{year:"numeric",month:"long"})}),(0,s.jsx)(i.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>g("next"),className:"p-2 rounded-full hover:bg-[hsl(var(--secondary))] transition-colors duration-200",children:(0,s.jsx)(C.A,{className:"h-4 w-4 text-[hsl(var(--muted-foreground))]"})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-2",children:[(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Dom","Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b"].map(e=>(0,s.jsx)("div",{className:"p-2 text-center text-xs font-medium text-[hsl(var(--muted-foreground))]",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1",children:u.map((e,a)=>{let t=p(e.date),r=e.date.toISOString().split("T")[0],l=d===r;return(0,s.jsxs)(i.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>o(r),className:"\n                    relative p-2 h-12 text-sm rounded-md transition-all duration-200\n                    ".concat(e.isCurrentMonth?"text-[hsl(var(--foreground))]":"text-[hsl(var(--muted-foreground))] opacity-50","\n                    ").concat(v(e.date)?"bg-red-400 text-white font-bold":"hover:bg-[hsl(var(--secondary))]","\n                    ").concat(l&&!v(e.date)?"bg-[hsl(var(--secondary))] ring-2 ring-red-400":"","\n                  "),children:[(0,s.jsx)("span",{className:"block",children:e.date.getDate()}),t.length>0&&(0,s.jsx)("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2",children:(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(v(e.date)?"bg-white":"bg-red-400")})})]},a)})})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-[hsl(var(--secondary))] rounded-lg p-4 transition-colors duration-200",children:[(0,s.jsxs)("h4",{className:"font-medium text-[hsl(var(--foreground))] mb-3 flex items-center",children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2 text-amber-400"}),d?"Citas del ".concat(new Date(d+"T00:00:00").toLocaleDateString("es-ES",{day:"numeric",month:"long"})):"Selecciona un d\xeda"]}),d?b.length>0?(0,s.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:b.map(e=>(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-[hsl(var(--card))] p-3 rounded-md border border-[hsl(var(--border))] transition-colors duration-200",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(k.A,{className:"h-3 w-3 mr-1 text-[hsl(var(--muted-foreground))]"}),(0,s.jsx)("span",{className:"text-sm font-medium text-[hsl(var(--foreground))]",children:N(e)})]}),(0,s.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(f(e.estado)),children:j(e.estado)})]}),(0,s.jsxs)("div",{className:"text-xs text-[hsl(var(--muted-foreground))] space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(h.A,{className:"h-3 w-3 mr-1"}),e.hora]}),(0,s.jsx)("div",{children:e.motivo}),(0,s.jsxs)("div",{className:"text-xs text-blue-600",children:["Dr. ",e.odontologoId.nombre," ",e.odontologoId.apellido]})]})]},e._id))}):(0,s.jsx)("p",{className:"text-sm text-[hsl(var(--muted-foreground))] italic",children:"No hay citas programadas para este d\xeda"}):(0,s.jsx)("p",{className:"text-sm text-[hsl(var(--muted-foreground))] italic",children:"Haz clic en un d\xeda para ver las citas programadas"})]})})]}),(0,s.jsx)("div",{className:"mt-4 text-center",children:(0,s.jsx)(M(),{href:"/dashboard/appointments",className:"text-sm font-medium text-red-400 hover:text-red-500 transition-colors duration-200",children:"Ver todas las citas →"})})]})};var T=t(6474);let I={year:{labels:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],values:[4e3,3e3,5e3,2780,1890,2390,3490,4e3,5e3,6e3,7e3,9e3]},semester:{labels:["Ene","Feb","Mar","Abr","May","Jun"],values:[4e3,3e3,5e3,2780,1890,2390]},quarter:{labels:["Ene","Feb","Mar"],values:[4e3,3e3,5e3]},month:{labels:["Semana 1","Semana 2","Semana 3","Semana 4"],values:[1200,1500,1300,1800]}},E=[{id:"year",label:"A\xf1o actual"},{id:"semester",label:"\xdaltimo semestre"},{id:"quarter",label:"\xdaltimo trimestre"},{id:"month",label:"\xdaltimo mes"}],F=()=>{var e;let[a,t]=(0,r.useState)("year"),[l,d]=(0,r.useState)(!1),{labels:o,values:c}=I[a],m=Math.max(...c);return(0,s.jsxs)(i.P.div,{whileHover:{boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},transition:{duration:.2},className:"bg-[hsl(var(--card))] rounded-lg shadow-md p-6 h-[500px] transition-colors duration-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-[hsl(var(--foreground))]",children:"Ingresos Mensuales"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{className:"flex items-center text-sm text-[hsl(var(--muted-foreground))] bg-[hsl(var(--secondary))] hover:bg-[hsl(var(--card-hover))] px-3 py-2 rounded-md transition-colors duration-200",onClick:()=>d(!l),children:[(0,s.jsx)(n.A,{className:"h-4 w-4 mr-2 text-red-400"}),null===(e=E.find(e=>e.id===a))||void 0===e?void 0:e.label,(0,s.jsx)(T.A,{className:"h-4 w-4 ml-2"})]}),l&&(0,s.jsx)(i.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-1 w-48 bg-[hsl(var(--card))] rounded-md shadow-lg z-10 border border-[hsl(var(--border))]",children:(0,s.jsx)("ul",{className:"py-1",children:E.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm ".concat(a===e.id?"bg-red-50 text-red-500 dark:bg-red-900/20 dark:text-red-400":"text-[hsl(var(--foreground))] hover:bg-[hsl(var(--secondary))]"),onClick:()=>{t(e.id),d(!1)},children:e.label})},e.id))})})]})]}),(0,s.jsx)("div",{className:"h-[380px] flex items-end justify-between",children:o.map((e,a)=>{let t=Math.max(10,c[a]/m*100);return(0,s.jsxs)("div",{className:"flex flex-col items-center group",children:[(0,s.jsxs)("div",{className:"absolute bottom-full mb-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-[hsl(var(--popover))] text-[hsl(var(--popover-foreground))] text-xs rounded py-1 px-2 pointer-events-none border border-[hsl(var(--border))]",children:["$",c[a]]}),(0,s.jsx)(i.P.div,{initial:{height:0},animate:{height:"".concat(2*t,"px")},transition:{duration:.5,delay:.1*a},className:"w-8 bg-red-400 hover:bg-red-500 transition-all rounded-t-sm cursor-pointer",style:{minHeight:"10px"}}),(0,s.jsx)("span",{className:"text-xs mt-2 text-[hsl(var(--muted-foreground))] font-medium",children:e}),(0,s.jsxs)("span",{className:"text-xs text-[hsl(var(--muted-foreground))]",children:["$",c[a]]})]},e)})})]})},H=()=>(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64 animate-pulse"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-48 mt-2 animate-pulse"})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("div",{className:"h-10 bg-gray-200 rounded w-24 animate-pulse"}),(0,s.jsx)("div",{className:"h-10 bg-gray-200 rounded w-20 animate-pulse"})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-gray-200",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4 animate-pulse"}),(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2 animate-pulse"})]},e))}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded w-48 mb-6 animate-pulse"}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-4",children:Array.from({length:35}).map((e,a)=>(0,s.jsx)("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},a))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded w-48 mb-4 animate-pulse"}),(0,s.jsx)("div",{className:"space-y-4",children:[1,2,3,4,5].map(e=>(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full animate-pulse"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2 animate-pulse"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 animate-pulse"})]})]},e))})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded w-48 mb-6 animate-pulse"}),(0,s.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})]})]})]}),R=()=>{var e,a,t,g;let{user:v}=(0,u.A)(),{stats:b,recentAppointments:f,activities:j,appointments:N,isLoading:w,error:A,refreshData:C,isReady:k}=function(){let{token:e,isAuthenticated:a,isHydrated:t}=(0,u.A)(),[s,l]=(0,r.useState)({stats:null,recentAppointments:[],activities:[],appointments:[]}),[i,d]=(0,r.useState)(!0),[n,o]=(0,r.useState)(null),[c,m]=(0,r.useState)(!1),x=(0,r.useCallback)(async()=>{if(!t||!a||!e){d(!1);return}try{o(null),c||d(!0);let a=(0,p.V)(e),[t,s,r,i]=await Promise.allSettled([a.getStats(),a.getRecentAppointments(5),a.getActivity(10),a.getAllAppointments()]),n={stats:"fulfilled"===t.status?t.value:null,recentAppointments:"fulfilled"===s.status?s.value.appointments:[],activities:"fulfilled"===r.status?r.value.activities:[],appointments:"fulfilled"===i.status?i.value.data:[]};l(n);let m=[t,s,r,i].filter(e=>"rejected"===e.status).map(e=>e.reason);m.length>0&&(console.warn("Algunos datos del dashboard fallaron al cargar:",m),o("Error al cargar algunos datos: ".concat(m.length," de 4 servicios fallaron")))}catch(e){console.error("Error cargando datos del dashboard:",e),o("Error al cargar los datos del dashboard")}finally{d(!1),m(!0)}},[t,a,e,c]);(0,r.useEffect)(()=>{x()},[x]);let h=(0,r.useCallback)(()=>{m(!1),x()},[x]);return{...s,isLoading:i,error:n,refreshData:h,isHydrated:t,hasInitialized:c,isReady:t&&c}}(),[D,T]=(0,r.useState)(!0);if(!k)return(0,s.jsx)(H,{});let I={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}},E=e=>{switch(e){case"completada":return"bg-green-100 text-green-800";case"pendiente":return"bg-blue-100 text-blue-800";case"cancelada":return"bg-red-100 text-red-800";case"Alerta":return"bg-amber-100 text-amber-800 border-amber-200";default:return"bg-gray-100 text-gray-800"}},R=e=>{switch(e){case"completada":return"Completada";case"pendiente":return"Pendiente";case"cancelada":return"Cancelada";default:return e}},_=e=>new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),L=new Date().toISOString().split("T")[0],O=f.filter(e=>e.fecha===L).length;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-[hsl(var(--foreground))]",children:"Panel Principal"}),(0,s.jsxs)("p",{className:"text-[hsl(var(--muted-foreground))]",children:["Bienvenido, ",null==v?void 0:v.nombre," ",null==v?void 0:v.apellido]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("button",{onClick:C,disabled:w,className:"flex items-center px-3 py-2 bg-[hsl(var(--card))] border border-[hsl(var(--border))] rounded-md text-sm font-medium text-[hsl(var(--foreground))] hover:bg-[hsl(var(--card-hover))] transition-colors duration-200 disabled:opacity-50",children:[(0,s.jsx)(d.A,{className:"h-4 w-4 mr-2 ".concat(w?"animate-spin":"")}),"Actualizar"]}),(0,s.jsxs)("button",{className:"flex items-center px-3 py-2 bg-[hsl(var(--card))] border border-[hsl(var(--border))] rounded-md text-sm font-medium text-[hsl(var(--foreground))] hover:bg-[hsl(var(--card-hover))] transition-colors duration-200",children:[(0,s.jsx)(n.A,{className:"h-4 w-4 mr-2 text-[hsl(var(--muted-foreground))]"}),"Hoy"]})]})]}),(0,s.jsxs)(l.N,{children:[D&&O>0&&(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-4 rounded-md flex justify-between items-center ".concat(E("Alerta")),children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(o.A,{className:"h-5 w-5 text-amber-500 mr-3"}),(0,s.jsxs)("p",{className:"text-amber-800",children:["Tienes ",O," cita",O>1?"s":""," pendiente",O>1?"s":""," para hoy."," ",(0,s.jsx)("a",{href:"/dashboard/appointments",className:"font-medium underline text-amber-800 hover:text-amber-900",children:"Ver citas"})]})]}),(0,s.jsx)("button",{onClick:()=>T(!1),className:"text-amber-500 hover:text-amber-700",children:"\xd7"})]}),A&&(0,s.jsx)(i.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-4 rounded-md bg-red-100 border border-red-200",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(o.A,{className:"h-5 w-5 text-red-500 mr-3"}),(0,s.jsx)("p",{className:"text-red-800",children:A})]})})]}),(0,s.jsxs)(i.P.div,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsx)(i.P.div,{variants:I,children:(0,s.jsx)(y,{title:"Pacientes Activos",value:(null==b?void 0:null===(e=b.totalPatients)||void 0===e?void 0:e.toString())||"0",icon:(0,s.jsx)(c.A,{className:"h-6 w-6 text-red-400"})})}),(0,s.jsx)(i.P.div,{variants:I,children:(0,s.jsx)(y,{title:"Citas Mensuales",value:(null==b?void 0:null===(a=b.monthlyAppointments)||void 0===a?void 0:a.toString())||"0",icon:(0,s.jsx)(n.A,{className:"h-6 w-6 text-amber-400"})})}),(0,s.jsx)(i.P.div,{variants:I,children:(0,s.jsx)(y,{title:"Tratamientos Completados este Mes",value:(null==b?void 0:null===(t=b.completedTreatments)||void 0===t?void 0:t.toString())||"0",icon:(0,s.jsx)(m.A,{className:"h-6 w-6 text-green-500"})})}),(0,s.jsx)(i.P.div,{variants:I,children:(0,s.jsx)(y,{title:"Ingresos del Mes",value:"$".concat((null==b?void 0:null===(g=b.revenueThisMonth)||void 0===g?void 0:g.toLocaleString())||"0"),icon:(0,s.jsx)(x.A,{className:"h-6 w-6 text-blue-500"})})})]}),(0,s.jsx)(i.P.div,{variants:I,initial:"hidden",animate:"visible",children:(0,s.jsx)(P,{appointments:N})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(i.P.div,{variants:I,initial:"hidden",animate:"visible",children:(0,s.jsx)(S,{activities:j})}),(0,s.jsx)(i.P.div,{variants:I,initial:"hidden",animate:"visible",children:(0,s.jsx)(F,{})})]}),(0,s.jsxs)(i.P.div,{variants:I,initial:"hidden",animate:"visible",className:"bg-[hsl(var(--card))] transition-colors duration-200 rounded-lg shadow-md p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-[hsl(var(--foreground))] mb-4 flex items-center",children:[(0,s.jsx)(h.A,{className:"h-5 w-5 mr-2 text-red-400"}),"Pr\xf3ximas Citas"]}),f.length>0?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-[hsl(var(--border))]",children:[(0,s.jsx)("thead",{className:"bg-[hsl(var(--secondary))]",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider",children:"Paciente"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider",children:"Fecha"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider",children:"Hora"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider",children:"Motivo"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider",children:"Estado"})]})}),(0,s.jsx)("tbody",{className:"bg-[hsl(var(--card))] divide-y divide-[hsl(var(--border))]",children:f.slice(0,3).map(e=>(0,s.jsxs)("tr",{className:"hover:bg-[hsl(var(--card-hover))] transition-colors duration-200",children:[(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-[hsl(var(--foreground))]",children:e.pacienteNombre}),(0,s.jsxs)("div",{className:"text-sm text-[hsl(var(--muted-foreground))]",children:["Dr. ",e.odontologoNombre]})]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm text-[hsl(var(--muted-foreground))]",children:_(e.fecha)})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm text-[hsl(var(--muted-foreground))]",children:e.hora})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm text-[hsl(var(--muted-foreground))]",children:e.motivo})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,s.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(E(e.estado)),children:R(e.estado)})})]},e.id))})]})}):(0,s.jsx)("p",{className:"text-[hsl(var(--muted-foreground))] text-center py-4",children:"No hay citas recientes"}),(0,s.jsx)("div",{className:"mt-4 text-right",children:(0,s.jsx)(M(),{href:"/dashboard/appointments",className:"text-sm font-medium text-red-400 hover:text-red-500 transition-colors duration-200",children:"Ver todas las citas →"})})]})]})}}}]);