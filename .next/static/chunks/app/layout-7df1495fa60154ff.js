(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1886:(e,t,o)=>{"use strict";async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,r="".concat("http://localhost:5000").concat(e),a={"Content-Type":"application/json",...t.headers};o&&(a.Authorization="Bearer ".concat(o));let n={...t,headers:a},l=await fetch(r,n);if(!l.ok){if(401===l.status)throw localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/",Error("Token inv\xe1lido");throw Error("Error ".concat(l.status,": ").concat(l.statusText))}return l.json()}o.d(t,{V:()=>n,Z:()=>a});let a={login:async e=>r("/api/auth/login",{method:"POST",body:JSON.stringify(e)}),register:async e=>r("/api/auth/register",{method:"POST",body:JSON.stringify(e)}),verify:async e=>r("/api/auth/verify",{method:"GET"},e)},n=e=>({getStats:()=>r("/api/dashboard/stats",{method:"GET"},e),getRecentAppointments:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return r("/api/dashboard/recent-appointments?limit=".concat(t),{method:"GET"},e)},getActivity:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return r("/api/dashboard/activity?limit=".concat(t),{method:"GET"},e)},getAllAppointments:()=>r("/api/citas",{method:"GET"},e)})},5414:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var r=o(2115);function a(){return(0,r.useEffect)(()=>{let e=!1;return(async()=>{if(!e){e=!0;try{let e=(await o.e(915).then(o.t.bind(o,4915,23))).default;await Promise.all([o.e(96),o.e(537)]).then(o.t.bind(o,9537,23)),e.init({duration:800,once:!1,disable:"mobile"})}catch(e){console.log("AOS animations disabled")}}})(),()=>{}},[]),null}},5731:(e,t,o)=>{"use strict";o.d(t,{A:()=>u,AuthProvider:()=>c});var r=o(5155),a=o(2115),n=o(1886);let l=(0,a.createContext)(null),i="auth_token",s="auth_user",c=e=>{let{children:t}=e,[o,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,m]=(0,a.useState)(null),[g,f]=(0,a.useState)(!0),[v,y]=(0,a.useState)(null),[p,S]=(0,a.useState)(!1);(0,a.useEffect)(()=>{S(!0)},[]),(0,a.useEffect)(()=>{p&&(async()=>{try{let e=localStorage.getItem(i),t=localStorage.getItem(s);if(e&&t)try{await n.Z.verify(e),m(e),d(JSON.parse(t)),c(!0),console.log("✅ Sesi\xf3n restaurada correctamente")}catch(e){console.error("❌ Token inv\xe1lido:",e),localStorage.removeItem(i),localStorage.removeItem(s),c(!1),d(null),m(null)}else console.log("ℹ️ No hay sesi\xf3n guardada"),c(!1)}catch(e){console.error("❌ Error al cargar la autenticaci\xf3n:",e),c(!1)}finally{f(!1)}})()},[p]);let b=async e=>{y(null);try{f(!0);let t=await n.Z.login(e),o={id:t.user._id,nombre:t.user.nombre,apellido:t.user.apellido,correo:t.user.correo,role:t.role,telefono:t.user.telefono,especialidad:t.user.especialidad};return m(t.token),d(o),c(!0),p&&(localStorage.setItem(i,t.token),localStorage.setItem(s,JSON.stringify(o))),console.log("✅ Login exitoso"),!0}catch(e){return console.error("❌ Error de inicio de sesi\xf3n:",e),y("Credenciales incorrectas. Por favor, int\xe9ntelo de nuevo."),!1}finally{f(!1)}},E=async e=>{y(null);try{return f(!0),await n.Z.register(e),!0}catch(e){return console.error("❌ Error de registro:",e),y("Error al registrar. Por favor, int\xe9ntelo de nuevo."),!1}finally{f(!1)}};return(0,r.jsx)(l.Provider,{value:{isAuthenticated:o,user:u,token:h,login:b,logout:()=>{c(!1),d(null),m(null),p&&(localStorage.removeItem(i),localStorage.removeItem(s)),console.log("✅ Logout exitoso")},register:E,isLoading:g,error:v,isHydrated:p},children:t})},u=()=>{let e=(0,a.useContext)(l);if(!e)throw Error("useAuth debe ser usado dentro de un AuthProvider");return e}},8806:(e,t,o)=>{Promise.resolve().then(o.t.bind(o,9324,23)),Promise.resolve().then(o.bind(o,5414)),Promise.resolve().then(o.bind(o,5731)),Promise.resolve().then(o.t.bind(o,9840,23))},9324:()=>{},9840:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_d65c78"}}},e=>{var t=t=>e(e.s=t);e.O(0,[385,441,684,358],()=>t(8806)),_N_E=e.O()}]);